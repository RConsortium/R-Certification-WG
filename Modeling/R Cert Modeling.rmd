---
output:
  html_document: default
  pdf_document: default
---
## R Cert Working Group-Modeling
### Joseph Korszun

## Library references
```{r, results=FALSE, message=FALSE}
#library references
library("gtsummary") #tabulation summary
library("utils") 
library("dplyr")
library("car") #levene test
library("haven") #sas datasets xpt
library("lme4") #mixed-effect modeling
library("survival") #survival

#set working directory
setwd("~/OneDrive - ProCogia/Desktop/R/R Cert Working Group/Code")

#load data into R
load('adsl.Rdata')

#load submissions group data 
adqs <- read_xpt("adqsadas.xpt") #linear model
adqsnpix <- read_xpt("adqsnpix.xpt") #mixed-effects model

#any of these below options 
View(adsl)
head(adsl)
summary(adsl)


```

## Descriptive Statistics
```{r, results=TRUE, warning=FALSE}
#descriptive statistics
#this package should be considered?
#better alternative?
library('psych')
describe(adqs)

```

## Aggregation Summaries
```{r, results=TRUE}
## Aggregation Summaries
group_by(adsl, SEX) %>%
  summarise(
    count = n(),
    mean = mean(AGE, na.rm = TRUE),
    sd = sd(AGE, na.rm = TRUE)
  )

```

## Continuous Table summaries
```{r, results=TRUE}
#Continuous-Table summaries
sub.df <- adsl %>% select(TRT01A, AGE, SEX)
sub.df %>% tbl_summary(by=TRT01A, statistic = list(all_continuous() ~ "{mean} ({sd})",
                       all_categorical() ~ "{n}/{N} ({p}%)"),
                       digits = all_continuous() ~ 2) %>%
  add_p(pvalue_fun = ~style_pvalue(.x, digits = 2))
```

## Cross Tabulation Summarie
```{r, results=TRUE}
#Cross Tabulation Summaries
adsl %>%
  tbl_cross(
    row = SEX,
    col = TRT01A,
    percent = "cell"
  ) %>%
  add_p()
```

## T-tests
```{r, results=TRUE}
## T-tests
adsl.t <- t.test(adsl$TRTDURD, y=NULL, alternative = c("two.sided"), mu=0, paired=FALSE,
       var.equal = FALSE, conf.level = 0.95)
# T-test output
adsl.t
```

## ANOVA
```{r, results=TRUE}
## ANOVA
adsl.aov <- aov(TRTDURD ~ TRT01A, data = adsl)

#summary
summary(adsl.aov)

#Tukey HSD Test for pairwise summary
TukeyHSD(adsl.aov)

#residual plots for homogeneity 
plot(adsl.aov, 1)

#normality assumption met
plot(adsl.aov, 2)

#Pull residual data
adsl_residuals <- residuals(object=adsl.aov)

#Shapiro-Wilkes Test, normality not met
shapiro.test(x = adsl_residuals)
```

## Statistical Tests
```{r, results=TRUE, warning=FALSE}
## Statistical Tests

#Levene's Test for Equal Variances
leveneTest(AGE ~ TRT01A, data = adsl)

#Fisher exact test



```

## General Linear Modeling
```{r, results=TRUE}
## General Linear Modeling

#subset data
glm_sub <- filter(adqs,EFFFL == 'Y' & AVISIT == 'Week 24' & PARAMCD == 'ACTOT') 

#build general linear model  
linear_model <- glm(CHG ~ TRTPN + SITEGR1, data = glm_sub)

#coefficients
linear_model$coefficients

#summary of results
summary(linear_model)

#95% confidence intervals for weights 
confint(linear_model)

#orthogonal effects 
effects <-linear_model$effects

#predicted values 
predicted_values <- predict(linear_model, type='response')
#linear_model$fitted.values

#print out residuals of response
residual_data <- residuals(linear_model, type='response')
#linear_model$residuals

#residual and predicted plots
plot(predicted_values, main = "Predicted Values")
plot(residual_data, main = "Residuals")
```

## Mixed-Modeling
```{r, results=TRUE}
## Mixed-Modeling
#page 11 of 240
mlm_sub <- filter(adqsnpix,EFFFL == 'Y' & AVISITN > 0 & PARAMCD == 'NPTOTMN' & ANL01FL=='Y') 

#mixed-model with site effects
melm <- lmer(AVAL~ (1|SITEGR1)+BASE+TRTPN,data=mlm_sub, REML = FALSE) #BASE dose for levels

#summary
summary(melm)

#confidence intervals
confint(melm)

#random effects
ranef(melm)

#anova for melm
anova(melm)

#residuals
melm_res <- residuals(melm)

#predictions
melm_pred <- predict(melm)

#plots
plot(melm_res, main = "MELM Rediduals")
plot(melm_pred, main = "MELM Predicted")


```

## Likelihood Estimates
```{r, results=TRUE}
## Likelihood Estimates 


```

## Survival Analysis
```{r, results=TRUE}
## Survival Analysis


```

## Covariate Adjustments
```{r, results=TRUE}
## Covariate Adjustments


```

## Sequential and Interim Analysis
```{r, results=TRUE}
## Sequential and Interim Analysis


```

## Bayesian Analysis
```{r, results=TRUE}
## Bayesian Analysis


```

## Experimental Design
```{r, results=TRUE}
## Experimental Design


```


## References/Tutorials
```{r, results=TRUE}
## References/Tutorials




```



